<mat-dialog-content>
  <form [formGroup]="articleForm">
    <div>
      <mat-form-field>
        <mat-label>Title</mat-label>
        <input matInput formControlName="title" required />
        <mat-error *ngIf="title.invalid && title.touched">
          <div *ngIf="title.errors?.required">Title is required.</div>
          <div *ngIf="title.errors?.minlength">
            Title must be at least 15 characters long.
          </div>
          <div *ngIf="title.errors?.maxlength">
            Title must not be 15 characters long.
          </div>
          <div *ngIf="title.errors?.forbiddenSpaceInput">
            Whitespaces are not allowed before or after alphabets.
          </div>
        </mat-error>
      </mat-form-field>
    </div>

    <div>
      <mat-form-field>
        <mat-label>Author</mat-label>
        <input matInput formControlName="author" required />
        <mat-error *ngIf="author.invalid && author.touched">
          <div *ngIf="author.errors?.required">Author is required.</div>
          <div *ngIf="author.errors?.minlength">
            Author must be at least 4 characters long.
          </div>
          <div *ngIf="author.errors?.maxlength">
            Author must not be 25 characters long.
          </div>
          <div *ngIf="author.errors?.forbiddenSpaceInput">
            Whitespaces are not allowed before or after alphabets.
          </div>
        </mat-error>
      </mat-form-field>
    </div>
    <div>
      <div>
        <mat-form-field>
          <mat-label>Content</mat-label>
          <textarea matInput formControlName="content" required></textarea>
          <mat-error *ngIf="content.invalid && content.touched">
            <div *ngIf="content.errors?.required">Review text is required.</div>
            <div *ngIf="content.errors?.minlength">
              Review text must be at least 10 characters long.
            </div>
            <div *ngIf="content.errors?.maxlength">
              Review text must not be more than 150 characters long.
            </div>
            <div *ngIf="content.errors?.forbiddenSpaceInput">
              Whitespaces are not allowed before or after alphabets.
            </div>
          </mat-error>
        </mat-form-field>
      </div>

      <div formArrayName="tags" class="-mt-3">
        <mat-label> Tags </mat-label>
        <div *ngFor="let tag of tags.controls; let i = index">
          <mat-form-field>
            <mat-label>Tag {{ i+1 }}</mat-label>
            <input
              matInput
              [id]="i"
              type="text"
              [formControlName]="i"
            />
            <mat-error *ngIf="tag.invalid && tag.touched">
              <div *ngIf="tag.errors?.['required']">Tag is required.</div>
              <div *ngIf="tag.errors?.['minlength']">
                Tag must be at least 4 characters long.
              </div>
              <div *ngIf="tag.errors?.['maxlength']">
                Tag must be not more than 20 characters long.
              </div>
              <div *ngIf="tag.errors?.['forbiddenSpaceInput']">
                Whitesapce are not allowed before or after alphabet.
              </div>
            </mat-error>
          </mat-form-field>
        </div>
      </div>
      <button
        mat-button
        color="primary"
        class="-mt-3 float-right" 
        [disabled]="tagsLength >= 4"
        (click)="addTagsField()"
      >
        + Add another Tag Field
      </button>
    </div>
  </form>
</mat-dialog-content>

<mat-dialog-actions>
  <button
    mat-raised-button
    color="primary"
    [mat-dialog-close]="true"
    (click)="addArticle()"
    *ngIf="!article; else update"
    [disabled]="articleForm.invalid"
  >
    Submit
  </button>
  <button mat-raised-button mat-dialog-close color="warn">Cancel</button>
</mat-dialog-actions>

<ng-template #update>
  <button
    mat-raised-button
    color="primary"
    (click)="updateArticle()"
    [disabled]="articleForm.invalid"
  >
    Update
  </button>
</ng-template>
